<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CMA レポート</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Meiryo, sans-serif; margin: 2rem; }
      .container { max-width: 1100px; margin: auto; }
      .card { border: 1px solid #ddd; padding: 1rem 1.5rem; border-radius: 8px; }
      .report table { border-collapse: collapse; width: 100%; }
      .report th, .report td { border: 1px solid #ccc; }
      details > pre { white-space: pre-wrap; background: #f8f9fa; padding: .5rem; border-radius: 6px; }
      a.btn { display:inline-block; margin:.5rem 0; padding:.6rem 1rem; background:#0d6efd; color:#fff; text-decoration:none; border-radius:6px; }
    </style>
  </head>
  <body>
    <div class="container">
      <a class="btn" href="/">← もう一度アップロード</a>
      <a class="btn" href="#" onclick="goBack('/')" style="background:#6b7280; margin-left:8px;">Back</a>
      <div class="card">
        {{ report_html|safe }}
        <p>
          <a class="btn" href="/download/docx">Word(.docx)をダウンロード</a>
        </p>
      </div>
    </div>
    <script>
      function goBack(fallback){ try{ if (window.history.length > 1){ window.history.back(); } else { window.location.href = fallback || '/'; } } catch(e){ window.location.href = fallback || '/'; } }
    </script>
  </body>
</html>
